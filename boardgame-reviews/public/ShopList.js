(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{EL6b:function(t,e,s){"use strict";s.r(e);var r=s("o0o1"),a=s.n(r),n=s("DxOX"),i=s("s2Yf"),o=s("9lOt"),u=s("tUrE"),c=s("Hd6p"),p=s("PEbx"),h=s("gIJd");function d(t,e,s,r,a,n,i){try{var o=t[n](i),u=o.value}catch(t){return void s(t)}o.done?e(u):Promise.resolve(u).then(r,a)}function l(t){return function(){var e=this,s=arguments;return new Promise((function(r,a){var n=t.apply(e,s);function i(t){d(n,r,a,i,o,"next",t)}function o(t){d(n,r,a,i,o,"throw",t)}i(void 0)}))}}var f,m,k,v,g,x={components:{shop:i.a,pagination:o.a,bdCarousel:u.a,bdSearchBox:c.a,bdSearchOptions:p.a,bdFloatBtn:h.a},data:function(){return{shops:[],currentPage:0,lastPage:0,hiddenShops:[]}},props:{page:{type:Number,required:!1,default:1}},computed:{simpleSuggestionList:function(){var t=[];return this.hiddenShops.forEach((function(e){t.push(e.shop_name)})),t}},methods:{fetchShops:(g=l(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,axios.get("/api/shops?page=".concat(this.$route.query.page));case 2:if((e=t.sent).status===n.d){t.next=6;break}return this.$store.commit("error/setCode",e.status),t.abrupt("return",!1);case 6:this.shops=e.data.data,this.hiddenShops=e.data.data,this.currentPage=e.data.current_page,this.lastPage=e.data.last_page;case 10:case"end":return t.stop()}}),t,this)}))),function(){return g.apply(this,arguments)}),onLikeClick:function(t){var e=t.id,s=t.liked;if(!this.$store.getters["auth/check"])return alert("いいねするにはログインをしてください"),!1;s?this.unlike(e):this.like(e)},like:(v=l(a.a.mark((function t(e){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,axios.put("/api/shops/".concat(e,"/like"));case 2:if((s=t.sent).status===n.d){t.next=6;break}return this.$store.commit("error/setCode",s.status),t.abrupt("return",!1);case 6:this.shops=this.shops.map((function(t){return t.id==s.data.shop_id&&(t.likes_count+=1,t.liked_by_user=!0),t}));case 7:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)}),unlike:(k=l(a.a.mark((function t(e){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,axios.delete("/api/shops/".concat(e,"/unlike"));case 2:if((s=t.sent).status===n.d){t.next=6;break}return this.$store.commit("error/setCode",s.status),t.abrupt("return",!1);case 6:this.shops=this.shops.map((function(t){return t.id==s.data.shop_id&&(t.likes_count-=1,t.liked_by_user=!1),t}));case 7:case"end":return t.stop()}}),t,this)}))),function(t){return k.apply(this,arguments)}),search:(m=l(a.a.mark((function t(e){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,axios.post("/api/shops/".concat(e));case 2:200==(s=t.sent).status?this.shops=s.data:this.$store.commit("error/setCode",s.status);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)}),setId:function(){this.$store.commit("ward/setId",null)},valuecheck:function(){}},watch:{$route:{handler:(f=l(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchShops();case 2:this.setId();case 3:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)}),immediate:!0}}},b=s("KHd+"),w=Object(b.a)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-list container"},[s("bd-search-box",{attrs:{simpleSuggestionList:t.simpleSuggestionList},on:{search:t.search,fetchShops:t.fetchShops}}),t._v(" "),s("div",{staticClass:"grid"},t._l(t.shops,(function(e){return s("shop",{key:e.id,staticClass:"grid__item",attrs:{item:e},on:{like:t.onLikeClick}})})),1),t._v(" "),s("pagination",{attrs:{"current-page":t.currentPage,"last-page":t.lastPage}}),t._v(" "),s("bdFloatBtn")],1)}),[],!1,null,null,null);e.default=w.exports}}]);